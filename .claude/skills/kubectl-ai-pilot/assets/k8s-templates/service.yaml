# Kubernetes Service Template
# Exposes your Deployment as a network service

apiVersion: v1
kind: Service
metadata:
  name: app-service  # TODO: Replace with your service name
  labels:
    app: myapp  # TODO: Replace with your app label
spec:
  type: ClusterIP  # TODO: Choose: ClusterIP, NodePort, or LoadBalancer
  selector:
    app: myapp  # Must match Deployment labels
  ports:
  - port: 80  # Service port
    targetPort: 8000  # Container port (must match Deployment containerPort)
    protocol: TCP
    name: http

---
# Alternative: NodePort Service (for external access in Minikube)
apiVersion: v1
kind: Service
metadata:
  name: app-service-nodeport
  labels:
    app: myapp
spec:
  type: NodePort
  selector:
    app: myapp
  ports:
  - port: 80
    targetPort: 8000
    nodePort: 30080  # External port (30000-32767)
    protocol: TCP
    name: http

---
# Alternative: LoadBalancer Service (for cloud environments)
apiVersion: v1
kind: Service
metadata:
  name: app-service-lb
  labels:
    app: myapp
spec:
  type: LoadBalancer
  selector:
    app: myapp
  ports:
  - port: 80
    targetPort: 8000
    protocol: TCP
    name: http

# ============================================================================
# Service Types Explanation
# ============================================================================
# ClusterIP (default):
#   - Internal cluster access only
#   - Accessible only within the cluster
#   - Use for backend services
#
# NodePort:
#   - Exposes service on each Node's IP at a static port
#   - Access via <NodeIP>:<NodePort>
#   - Useful for Minikube development
#   - Port range: 30000-32767
#
# LoadBalancer:
#   - Exposes service externally using cloud provider's load balancer
#   - Use in production cloud environments (AWS, GCP, Azure)
#   - Not supported in Minikube (requires MetalLB or similar)
#
# ============================================================================
# Usage Instructions
# ============================================================================
# 1. Choose one service type (delete the other two)
#
# 2. Replace TODOs with your actual values:
#    - app-service → your-service-name
#    - myapp → your-app-label (must match Deployment)
#    - 8000 → your-container-port (must match Deployment)
#
# 3. Apply to cluster:
#    kubectl apply -f service.yaml
#
# 4. Verify service:
#    kubectl get services
#    kubectl describe service app-service
#
# 5. Test service (ClusterIP):
#    kubectl run -it --rm debug --image=curlimages/curl --restart=Never -- \
#      curl http://app-service
#
# 6. Test service (NodePort in Minikube):
#    minikube service app-service-nodeport
#
# 7. Get service URL (Minikube):
#    minikube service app-service-nodeport --url
