# Global configuration
global:
  environment: local
  labels:
    app: todo
    managedBy: helm

# Backend configuration
backend:
  enabled: true
  replicaCount: 2

  image:
    repository: todo-backend
    tag: local
    pullPolicy: Never

  service:
    type: ClusterIP
    port: 8000
    targetPort: 8000

  resources:
    requests:
      cpu: 500m
      memory: 512Mi
    limits:
      cpu: 1000m
      memory: 1024Mi

  healthProbes:
    readiness:
      path: /health/ready
      port: 8000
      initialDelaySeconds: 10
      periodSeconds: 5
      timeoutSeconds: 3
      successThreshold: 1
      failureThreshold: 3
    liveness:
      path: /health/live
      port: 8000
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 3
      successThreshold: 1
      failureThreshold: 3

  env:
    LOG_LEVEL: info
    WORKERS: "1"

# Frontend configuration
frontend:
  enabled: true
  replicaCount: 1

  image:
    repository: todo-frontend
    tag: local
    pullPolicy: Never

  service:
    type: NodePort
    port: 3000
    targetPort: 3000
    nodePort: 30080  # Fixed for local development

  resources:
    requests:
      cpu: 250m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi

  healthProbes:
    readiness:
      path: /
      port: 3000
      initialDelaySeconds: 5
      periodSeconds: 5
      timeoutSeconds: 3
      successThreshold: 1
      failureThreshold: 3
    liveness:
      path: /
      port: 3000
      initialDelaySeconds: 15
      periodSeconds: 10
      timeoutSeconds: 3
      successThreshold: 1
      failureThreshold: 3

  env:
    NEXT_PUBLIC_API_URL: http://backend-service:8000

# Secrets configuration
secrets:
  name: todo-secrets
  create: false  # Manually created via kubectl
  keys:
    - DATABASE_URL
    - OPENAI_API_KEY
    - BETTER_AUTH_SECRET

# ConfigMap configuration
configMap:
  name: todo-config
  data:
    APP_NAME: "Todo Chatbot"
    ENVIRONMENT: "{{ .Values.global.environment }}"

# Ingress configuration (optional)
ingress:
  enabled: false
  className: nginx
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod
  hosts:
    - host: todo.example.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: todo-tls
      hosts:
        - todo.example.com
